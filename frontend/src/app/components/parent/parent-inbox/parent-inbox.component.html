<div class="parent-dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2>Parent Portal</h2>
      <p class="user-info">{{ parentName }}</p>
    </div>
    
    <nav class="sidebar-nav">
      <div class="menu-section">
        <ul class="menu-list">
          <li><a routerLink="/parent/dashboard" routerLinkActive="active">
            <span class="menu-icon">ğŸ“Š</span> Dashboard
          </a></li>
          <li><a routerLink="/parent/inbox" routerLinkActive="active">
            <span class="menu-icon">ğŸ“§</span> My Inbox
          </a></li>
          <li><a routerLink="/parent/send-message" routerLinkActive="active">
            <span class="menu-icon">âœ‰ï¸</span> Send Message
          </a></li>
          <li><a routerLink="/parent/outbox" routerLinkActive="active">
            <span class="menu-icon">ğŸ“¤</span> Outbox
          </a></li>
        </ul>
      </div>

      <!-- Logout -->
      <div class="menu-section logout-section">
        <ul class="menu-list">
          <li><a (click)="logout()" style="cursor: pointer; color: #dc3545;">
            <span class="menu-icon">ğŸšª</span> Logout
          </a></li>
        </ul>
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="inbox-header">
      <h1>ğŸ“§ My Inbox</h1>
      <p class="welcome-text">Messages from the school</p>
    </div>

    <div class="alert alert-error" *ngIf="error" style="color: red; font-weight: bold;">{{ error }}</div>

    <div *ngIf="loading" class="loading-message">Loading messages...</div>

    <div *ngIf="!loading && messages.length === 0" class="empty-state">
      <div class="empty-state-content">
        <h2>ğŸ“­ No Messages</h2>
        <p>You don't have any messages yet. Messages from the school will appear here.</p>
      </div>
    </div>

    <div *ngIf="!loading && messages.length > 0" class="messages-section">
      <div *ngFor="let message of messages" class="message-card">
        <div class="message-header">
          <h3>{{ message.subject }}</h3>
          <span class="message-date">{{ formatDate(message.createdAt) }}</span>
        </div>
        <div class="message-content">
          <p>{{ message.message }}</p>
        </div>
        <div class="message-footer">
          <span class="message-sender">From: {{ message.senderName || 'School Administration' }}</span>
          <button class="btn btn-primary" (click)="openReply(message)" *ngIf="replyingForId !== message.id">Reply</button>
        </div>
        <div class="reply-section" *ngIf="replyingForId === message.id">
          <div class="reply-row">
            <label>Recipient</label>
            <select [(ngModel)]="replyRecipient">
              <option value="admin">Administrator</option>
              <option value="accountant">Accountant</option>
            </select>
          </div>
          <div class="reply-row">
            <label>Subject</label>
            <input type="text" [(ngModel)]="replySubject" />
          </div>
          <div class="reply-row">
            <label>Message</label>
            <textarea rows="6" [(ngModel)]="replyBody" placeholder="Type your reply..."></textarea>
          </div>
          <div class="reply-row">
            <label>Attachments (optional)</label>
            <input type="file" multiple (change)="onFileChange($event)" />
            <div class="attachments" *ngIf="attachments.length">
              <div class="attachment-item" *ngFor="let f of attachments; let i = index">
                {{ f.name }} ({{ f.size }} bytes)
                <button class="btn btn-link" type="button" (click)="removeAttachment(i)">Remove</button>
              </div>
            </div>
          </div>
          <div class="reply-actions">
            <button class="btn btn-secondary" (click)="cancelReply()" [disabled]="sending">Cancel</button>
            <button class="btn btn-primary" (click)="sendReply()" [disabled]="sending">
              <span *ngIf="!sending">Send Reply</span>
              <span *ngIf="sending">Sending...</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

