<div class="container modern-container">
  <div class="page-header modern-header-section">
    <div class="header-content">
      <div class="header-title-section">
        <div class="header-icon-wrapper">
          <span class="header-main-icon">üìã</span>
        </div>
        <div>
          <h1>Outstanding Invoices</h1>
          <p class="header-subtitle">View all uncleared invoice balances</p>
        </div>
      </div>
      <div class="header-actions" *ngIf="!loading && balances.length > 0">
        <button type="button" class="btn-preview-pdf" (click)="previewPdf()" [disabled]="loadingPdf" title="Preview report in PDF (you can download from the browser)">
          <span class="btn-icon" *ngIf="!loadingPdf">üìÑ</span>
          <span class="btn-icon" *ngIf="loadingPdf">‚è≥</span>
          <span>{{ loadingPdf ? 'Loading...' : 'Preview PDF' }}</span>
        </button>
      </div>
    </div>
  </div>

  <div class="alert alert-error modern-alert" *ngIf="error">
    <span class="alert-icon">‚ö†Ô∏è</span>
    <span>{{ error }}</span>
    <button class="alert-close" (click)="error = ''" title="Close">&times;</button>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading outstanding invoices...</p>
  </div>

  <div *ngIf="!loading && balances.length === 0" class="empty-state">
    <div class="empty-icon">‚úÖ</div>
    <h2>No Outstanding Invoices</h2>
    <p>All invoice balances have been cleared.</p>
  </div>

  <div *ngIf="!loading && balances.length > 0" class="table-section">
    <div class="table-header-bar">
      <span class="table-info-text">{{ balances.length }} student(s) with outstanding balances</span>
    </div>
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Student ID</th>
            <th>Full Name</th>
            <th>Phone Number</th>
            <th class="text-right">Invoice Balance</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of balances; let i = index">
            <td class="row-num">{{ i + 1 }}</td>
            <td class="student-id">{{ row.studentNumber || row.studentId || '‚Äî' }}</td>
            <td class="full-name">{{ getFullName(row) }}</td>
            <td class="phone">{{ row.phoneNumber || '‚Äî' }}</td>
            <td class="balance text-right">{{ currencySymbol }} {{ formatCurrency(row.invoiceBalance) }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="4" class="footer-label text-right"><strong>Total Outstanding:</strong></td>
            <td class="footer-value text-right">
              <strong>{{ currencySymbol }} {{ formatCurrency(getTotalOutstanding()) }}</strong>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
